# 立项报告
> 基于人工智能的3D 医疗 Web 平台
> - 5.26 10:21
本项目是 `软件杯 医疗影像` 赛道的参赛项目。该比赛需要我们利用人工智能、大数据及 `Web3.0` 等先进技术为传统医疗影像行业赋能，促进医疗行业的信息化、智能化发展。
## 可行性分析
### 政策 （于）
### 经济 （韦）
基于人工智能的3D 医疗 Web 平台系统具有广阔的市场前景和可持续发展性，不仅能提高医疗服务的质量和效率，更能够有效降低医疗成本，为医疗机构带来可观的经济效益。

市场需求：随着人们健康意识的提高，医疗健康行业的市场需求不断增长。据统计，全球医疗市场规模已超过1万亿美元，而人工智能技术在医疗健康领域的应用前景广阔。因此，本项目具有良好的市场前景和商业价值。

竞争分析：目前，国内外已有一些医疗健康领域的人工智能企业涉足3D可视化技术。然而，本项目的特色在于将人工智能技术与3D技术相结合，实现医疗数据的高效可视化和智能分析，具有较强的竞争优势。

风险分析：本项目存在技术研发风险、市场风险和资金风险等方面的风险。但是，我们将采取有效的风险管理措施，降低风险发生的概率和影响，确保项目的稳定发展。
### 技术上进行分析 （潘）
#### 技术概述
本项目前后端分离，前端采用 `JavaScript` 语言的 `Vue` 框架搭建，后端使用 `Python` 语言的 `Flask` 框架实现一套 `RESTful` 接口以支持业务。其中人工智能部分的特色功能通过调用部署在百度 `AIStudio` 上的模型接口来实现。为了经一步加强项目的健壮性，减少不必要的耦合，我们专门使用 `Orthanc` 软件来管理医疗影像数据。以下是架构略图
```mermaid
graph LR
    subgraph 前端
        A[Vue]
    end
    subgraph 后端
        B[Flask]
    end
    subgraph 数据库
        C[Orthanc]
    end
    subgraph 人工智能
        D[AIStudio]
    end
    A --> B
    B --> C
    B --> D
```
> 项目托管在 `GitHub` 平台上，由于参加比赛的缘故，尚未开源。比赛结束后，我们会整理好项目，并开放源码。
#### 前端项目技术分析

前端项目使用 `Vue` 框架搭建，使用 `Element Plus` 作为组件库，使用 `axios` 作为网络请求库，使用 `vue-router` 作为路由管理器。同时，为了满足医疗影像行业的一般需求，我们使用 `cornerstone.js` ， `D3.js` 及 `VTK.js` 等前端包来支撑医疗影像数据的展示、标注、管理及三维分析。为了贴合业界生产实际，我们采用 `Vite` 作为打包工具，实现自动化构建。

为了便于项目管理、构建及代码复用，我们采用 模块化、组件化 的方式构建前端项目。

我们充分利用 `Vue 组合式 api` 的特点，将那些重复的、易于复用的业务逻辑封装为模块（没有视图的组件）。这些模块主要包括：数据管理及获取模块、人工智能模型管理模块、预测后处理模块、错误处理模块等。由于医疗影像数据众多，结构复杂，管理困难，我们封装 `dcmjs` 及 `dicomweb-client.js`用以快速加载和检索医疗影像数据。为了便于使用百度提供的模型接口，我们将该接口封装为单独模块，并于模型管理视图配合实现拖拽式部署数据流的特色功能。人工智能模型预测结构难免有误差，所以需要人工修正。这一块需要综合数据获取、数据修改、数据检索等常规功能，所以可以将其封装为单独的模块。这些模块将必要的功能接口以命令及函数的形式暴露出来，最大限度方便视图组件的调用。

为了适应医疗影像行业的需求，我们搭建了不同的组件包括：三维展示组件、二维展示组件、数据检索与管理表格组件、人工智能模型管理组件等。通过灵活地组合与复用这些组件，我们可以快速构建适用于不同医疗影像工作流的应用页面。

以下是设计示意图：
```mermaid
graph LR
    subgraph 三维展示组件
        A[Cornerstone.js]
        B[D3.js]
        C[VTK.js]
    end
    subgraph 二维展示组件
        D[Cornerstone.js]
    end
    subgraph 数据检索与管理表格组件
        E[Element Plus]
    end
    subgraph 人工智能模型管理组件
        F[Element Plus]
    end
    A --> B
    A --> C
    D --> E
    F --> E
```
以下是模块及组件的关系图：
```mermaid
graph LR
    subgraph 模块
        A[数据管理及获取模块]
        B[人工智能模型管理模块]
        C[预测后处理模块]
        D[错误处理模块]
    end
    subgraph 组件
        E[三维展示组件]
        F[二维展示组件]
        G[数据检索与管理表格组件]
        H[人工智能模型管理组件]
    end
    A --> E
    A --> F
    A --> G
    A --> H
    B --> H
    C --> E
    C --> F
    C --> G
    D --> E
    D --> F
    D --> G
    D --> H

```


## 需求分析 
### 项目的定义 （于）
### 功能性与非功能性需求 （韦）
#### 功能性需求
1.3D数据读取与推理(包括导入数据、加载模型和分割预测)
- 导入数据: 图像支持格式包含 `nii,nii.gz,mhd,raw,dcm` 等常见格式
- 加载模型: 支持模型的介绍、选择与加载
- 分割预测: 基于导入模型，对任一测试数据进行推理分割并将分割后的结果保存为标签
- 标签管理: 支持标签的增删、修改和颜色的切换；支持标签的导出保存，导出的标签格式和输入图像格式一致；（通常来说，图像分割的输入是一张图像，输出也是一张图像，每个像素点都对应一个标签。）
2.预测展示
- 原图和标签支持3D可视化三视图展示原图和标签显示，每个视图支持鼠标拖动进行切片切换、鼠标拖动带动3D原点的变化，视图支持缩放和窗宽窗位调整支持使用`笔刷`、`橡皮擦`、`提取最大连通域`等方式对模型推理分割结果进行优化，并将结果在三视图和 `3D 渲染效果`中展示.
- 数据分析
  - 测量: 基于 `spacing` 等参数，获取测量分割目标在 `x, y, z` 切面上的直径、面积和目标体积等结果
  - 计数: 基于现有分割结果，统计不同类别数据的个数，例如某类病灶的计数
  - 自定义数据分析: 基于用户上传的后处理脚本返回结果进行合理的展示和分析（可以规定后处理的返回内容和方式）
  - 统计结果展示: 针对用户上传的所有医疗数据进行上述分析，并对分析结果进行图标展示.并支持显示所有符合`筛选`要求的数据索引
3.其他附加功能
- 根据各类分割及分析结果，自动生成高质量病例报告。
- 筛选: 支持根据数据的属性进行筛选，例如数据的年龄、性别、病灶类型等
#### 非功能性需求
1.安全需求：系统必须具备安全性和隐私性保护机制，确保医学数据及时、准确、安全的传输和存储。
2.可靠性需求：对输入的数据有提示，有检查，防止数据异常。并且系统健壮性强，应该能处理系统运行过程中出现的各种异常情况，如：人为操作错误、输入非法数据、硬件设备失败等，系统应该能正确的处理，恰当的回避。
3.兼容性需求：系统应支持IOS，Android , Windows操作系统
4.易用性需求：在网站主界面应简洁地表现大部分常用功能，使用户在一定时间内便可找到所需的功能
5.可维护性需求：90%的BUG修改时间不超过1个工作日，其他不超过2个工作日。产品必须提供可跟踪任何数据库字段的工具。
6.性能需求：业务量方面，最大操作并发数为50，系统可以同时满足100个用户请求，并为200个并发用户提供浏览功能。系统容量应足够大，以存放相应的数据

### 需要的数据 （潘）
#### 医疗影像数据
医学影像是指为了医疗或医学研究，对人体或人体某部份，以非侵入方式取得内部组织影像的技术与处理过程。目前的主要处理方式有：X光成像（X-ray），电脑断层扫描（CT），核磁共振成像（MRI）， 超声成像（ultrasound），正子扫描（PET），脑电图（EEG），脑磁图（MEG），眼球追踪（eye-tracking），穿颅磁波刺激（TMS）等现代成像技术，用来检查人体无法用非手术手段检查的部位的过程。

一些常用的医疗影像数据格式：
- `NIfTI` nii(nii.gz) 
  - 定义：NIfTI格式是神经图像信息技术倡议（Neuroimaging Informatics Technology Initiative）的缩写，是一种自由文件格式，用于储存磁共振成像获取的大脑成像数据。
- `mhd(raw)`
    - mhd + raw 格式是常见的一种医学图像格式，每一个病人的数据包含一个mhd文件和一个同名的raw文件，使用Python的SimpleITK库即可读取。其中：
      1. mhd（数据头部信息）：存放数据的非图像信息，如图像大小、切片大小、像素大小等。
      2. raw（未加工的数据）：存储病人的图像信息，往往是三维体数据。（可以理解为将该病人不同的dicom切片图像都叠到一起，形成了一个三维图像，也就是我们通常处理的数据）。
- `dcm`
  - dcm 是 DICOM 这种医学影像文件的格式。
  - DICOM(DigitalImaging andCommunications inMedicine)是指医疗数字影像传输协定，是用于医学影像处理、储存、打印、传输的一组通用的标准协定。
    - 它包含了文件格式的定义以及网络通信协议。DICOM是以TCP/IP为基础的应用协定，并以TCP/IP联系各个系统。
    - 两个能接受DICOM格式的医疗仪器间，可通过DICOM格式的文件，来接收与交换影像及病人资料。
    - 目前，DICOM被广泛应用于放射医疗，心血管成像以及放射诊疗诊断设备（X射线，CT，核磁共振，超声等），并且在眼科和牙科等其它医学领域得到越来越深入广泛的应用。
支持模型的介绍、选择与加载
### 业务流程等 （覃）
